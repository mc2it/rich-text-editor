<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>MC2IT Rich Text Editor: cli/build.js</title>
    
      <link type="text/css" rel="stylesheet" href="styles/vendor/prism-tomorrow-night.css">
    
    <link type="text/css" rel="stylesheet" href="styles/styles.css">
    
</head>
<body>

<header class="layout-header">
  
    <a href="./">
      <img
        src="favicon.svg"
        alt="MC2IT Rich Text Editor"
      >
    </a>
  
  <h1>
    <a href="./index.html">
      MC2IT Rich Text Editor
    </a>
  </h1>
  <nav class="layout-nav">
    <ul><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="RichTextEditor.html">RichTextEditor</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="RichTextEditor.html#builtinPlugins">builtinPlugins</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="RichTextEditor.html#defaultConfig">defaultConfig</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="RichTextEditor.html#.create">create</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="Timestamp.html">Timestamp</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Timestamp.html#pluginName">pluginName</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Timestamp.html#requires">requires</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="TimestampCommand.html">TimestampCommand</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="TimestampCommand.html#execute">execute</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="TimestampCommand.html#refresh">refresh</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="TimestampEditing.html">TimestampEditing</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="TimestampEditing.html#requires">requires</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="TimestampEditing.html#init">init</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="TimestampUI.html">TimestampUI</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="TimestampUI.html#init">init</a></span></li></ul><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="global.html#buildBundle">buildBundle</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="global.html#copyAssets">copyAssets</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#EditorConfig">EditorConfig</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="global.html#getAssetPath">getAssetPath</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="global.html#getLanguageFiles">getLanguageFiles</a></span></li>
  </nav>
</header>


<main class="layout-main  layout-content--source">
  <div class="container">
    <p class="page-kind">source</p>
    <h1 class="page-title">cli/build.js</h1>
    



    

<section>
    <article>
        <pre id="source" class="source-page line-numbers"><code class="language-js">import {existsSync, mkdirSync, readdirSync, readFileSync, writeFileSync} from "node:fs";
import {EOL} from "node:os";
import {dirname, join} from "node:path";
import {fileURLToPath} from "node:url";
import {Command} from "commander";

/**
 * Creates a custom build to a given file.
 * @param {string} output The path to the output file.
 * @param {Object} [options] The command line options.
 * @param {string[]} [options.languages] A list of languages to embed.
 */
export function buildBundle(output, options = {}) {
	mkdirSync(dirname(output), {recursive: true});

	const input = fileURLToPath(new URL("../../www/js", import.meta.url));
	const files = [
		readFileSync(join(input, "mc2it_rte.js"), "utf8"),
		...getLanguageFiles(options?.languages ?? []).map(file => readFileSync(file, "utf8"))
	];

	writeFileSync(output, files.join(EOL));
}

/**
 * Returns the file paths corresponding to the provided languages.
 * @param {string[]} languages The language codes.
 * @returns {string[]} The file paths corresponding to the provided languages that exist.
 */
function getLanguageFiles(languages) {
	if (!languages.length) return [];

	const input = fileURLToPath(new URL("../../www/js/i18n", import.meta.url));
	return languages.at(0) == "all"
		? readdirSync(input).map(file => join(input, file))
		: languages.map(language => `${language.toLowerCase()}.js`).map(file => join(input, file)).filter(existsSync);
}

/**
 * Command creating a custom build to a given file.
 * @type {Command}
 */
export default new Command("build")
	.description("Create a custom build to a given file.")
	.argument("file", "the path to the output file")
	.option("-l, --languages &lt;codes>", "a comma separated list of languages to embed", value => value.split(","))
	.action(buildBundle);
</code></pre>
    </article>
</section>




  </div>
</main>

<footer class="layout-footer">
  <div class="container">
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.10</a>
  </div>
</footer>



<script src="scripts/prism.dev.js"></script>
</body>
</html>
